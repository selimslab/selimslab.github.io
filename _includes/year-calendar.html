<div class="column is-8">
  <div class="year-grid"></div>
</div>

<style>
  :root {
    --point-size: 0.32rem;
    --point-gap: 0.32rem;
    --row-gap: 0.48rem;
  }

  .year-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-gap: 1rem;
  }

  .month-container {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .month-title {
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
  }

  .days {
    list-style-type: none;
    display: grid;
    grid-auto-flow: row;
    grid-gap: var(--point-gap);
    row-gap: var(--row-gap);
    grid-auto-rows: var(--point-size);
    grid-template-columns: repeat(7, var(--point-size));
    width: max-content;
  }

  .days li {
    margin: 0;
    border-radius: 50%;
  }

  .weekday { background-color: #fff; }
  .filler { background-color: inherit; }
  .past { opacity: 0.5; }
  .weekend { background-color: #ffcc00e2; }
  .now { background-color: rgb(255, 55, 0); }

  html[data-theme='light'] {
    .weekday { background-color: #b2afaf; }
    .now { background-color: rgb(255, 55, 0); }
  }
</style>

<script>
  function renderCalendar(container, currentDayOfYear) {
    const yearGrid = container;
    const today = moment();
    const currentYear = today.year();
    const monthNames = moment.months();
    
    // Clear the container
    while (yearGrid.firstChild) {
      yearGrid.removeChild(yearGrid.firstChild);
    }
    
    // Render each month separately
    for (let month = 0; month < 12; month++) {
      // Create month container
      const monthContainer = document.createElement("div");
      monthContainer.classList.add("month-container");
      
      // Add month title
      const monthTitle = document.createElement("div");
      monthTitle.classList.add("month-title");
      monthTitle.textContent = monthNames[month];
      monthContainer.appendChild(monthTitle);
      
      // Create days container for this month
      const daysContainer = document.createElement("ul");
      daysContainer.classList.add("days");
      monthContainer.appendChild(daysContainer);
      
      // Render the month calendar
      renderMonthCalendar(daysContainer, month, currentYear);
      
      // Add to the grid
      yearGrid.appendChild(monthContainer);
    }
  }
  
  // Function to render a single month calendar
  function renderMonthCalendar(container, month, year) {
    const today = moment();
    const currentDay = today.date();
    const currentMonth = today.month();
    const currentYear = today.year();
    const currentDayOfYear = today.dayOfYear();
    
    const monthData = getMonthData(month, year);
    const firstDayOfMonth = moment({ year, month, day: 1 }).day();
    
    // Add fillers for days before the first day of month
    addFillerDays(container, firstDayOfMonth);
    
    // Add the actual days
    for (let day = 1; day <= monthData.daysInMonth; day++) {
      const dayElement = document.createElement("li");
      
      // Add proper classes
      if (monthData.weekendDays.includes(day)) {
        dayElement.classList.add("weekend");
      } else {
        dayElement.classList.add("weekday");
      }
      
      // Calculate the day of year for this date
      const dayOfYear = moment({ year, month, day }).dayOfYear();
      
      // Highlight current day
      if (day === currentDay && month === currentMonth && year === currentYear) {
        dayElement.classList.add("now");
      } else if (dayOfYear < currentDayOfYear && year === currentYear) {
        dayElement.classList.add("past");
      }
      
      container.appendChild(dayElement);
    }
    
    // Add fillers to complete the grid if needed
    const totalCells = 7 * Math.ceil((firstDayOfMonth + monthData.daysInMonth) / 7);
    const fillersNeeded = totalCells - firstDayOfMonth - monthData.daysInMonth;
    addFillerDays(container, fillersNeeded);
  }
  
  // Get data for a specific month
  function getMonthData(month, year) {
    const daysInMonth = moment({ year, month }).daysInMonth();
    const weekendDays = [];
    
    for (let day = 1; day <= daysInMonth; day++) {
      const date = moment({ year, month, day });
      if (date.day() === 0 || date.day() === 6) {
        weekendDays.push(day);
      }
    }
    
    return { daysInMonth, weekendDays };
  }
  
  // Create empty filler element
  function createFillerElement() {
    const filler = document.createElement("li");
    filler.classList.add("filler");
    return filler;
  }
  
  // Add multiple filler elements
  function addFillerDays(container, count) {
    for (let i = 0; i < count; i++) {
      container.appendChild(createFillerElement());
    }
  }
</script> 