<!-- Simple Audio Player -->
<div class="audio-player">
  <div id="now-playing"></div>
  <audio id="audio-player" controls></audio>
</div>

<div id="playlist"></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const audioPlayer = document.getElementById('audio-player');
  const nowPlaying = document.getElementById('now-playing');
  const playlist = document.getElementById('playlist');
  
  // Load tracks from JSON file
  fetch('/assets/data/tracks.json')
    .then(response => response.json())
    .then(data => {
      // Create summary/detail elements for each genre
      Object.entries(data).forEach(([genre, tracks]) => {
        const details = document.createElement('details');
        const summary = document.createElement('summary');
        summary.textContent = genre;
        details.appendChild(summary);
        
        // Create track list
        const trackList = document.createElement('ul');
        
        tracks.forEach(track => {
          const trackElement = document.createElement('li');
          trackElement.classList.add('track');
          trackElement.textContent = track.title;
          trackElement.dataset.id = track.id;
          
          trackElement.addEventListener('click', function() {
            document.querySelectorAll('.track').forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            const trackPath = `/assets/static/music/${genre}/${track.title}.mp3`;
            audioPlayer.src = trackPath;
            nowPlaying.textContent = track.title;
            audioPlayer.play();
          });
          
          trackList.appendChild(trackElement);
        });
        
        details.appendChild(trackList);
        playlist.appendChild(details);
      });
    })
    .catch(error => console.error('Error loading track list:', error));
});
</script>

<style>
  .audio-player {
    position: sticky;
    top: 0;
    font-size: 0.9rem;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    z-index: 10;
  }

  #audio-player {
    width: 100%;
  }

  #now-playing {
    font-family: "Atkinson Hyperlegible Mono", "Inconsolata", monospace;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
    margin-left: 1rem;
    background-color: #1b1c1d;
  }

  .player-controls {
    display: flex;
    justify-content: right;
  }

  .player-controls button {
    background-color: #1b1c1d;
    font-family: "Atkinson Hyperlegible Mono", "Inconsolata", monospace;
    cursor: pointer;
    border: none;
    font-size: 0.9rem;
  }

  #shuffle-button.active {
    color: #FF530D;
  }

  .track {
    cursor: pointer;
  }

  .track:hover {
    text-decoration: underline;
  }

  .track.active {
    color: #FF530D;
  }

  .track-list {
    margin-bottom: 1rem;
  }
</style>
